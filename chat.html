<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <title>BidDeed.AI Chat</title>
    <style>
        * { box-sizing: border-box; margin: 0; padding: 0; }
        :root {
            --bg-primary: #0f172a;
            --bg-secondary: #1e293b;
            --accent: #3b82f6;
            --text-primary: #f0f0f5;
            --text-secondary: #94a3b8;
            --user-bubble: #3b82f6;
            --claude-bubble: #334155;
            --success: #22c55e;
            --warning: #eab308;
            --gemini: #8b5cf6;
        }
        html, body { height: 100%; font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; background: var(--bg-primary); color: var(--text-primary); overflow: hidden; }
        .app { display: flex; flex-direction: column; height: 100%; max-width: 900px; margin: 0 auto; }
        header { padding: 12px 16px; background: var(--bg-secondary); border-bottom: 1px solid rgba(59,130,246,0.2); display: flex; justify-content: space-between; align-items: center; }
        .logo { display: flex; align-items: center; gap: 10px; }
        .logo h1 { font-size: 1.1rem; font-weight: 600; }
        .status { font-size: 0.75rem; padding: 4px 10px; border-radius: 12px; display: flex; align-items: center; gap: 6px; }
        .status.ready { background: rgba(34,197,94,0.2); color: var(--success); }
        .status.working { background: rgba(59,130,246,0.2); color: var(--accent); }
        .status.gemini { background: rgba(139,92,246,0.2); color: var(--gemini); }
        .status-dot { width: 6px; height: 6px; border-radius: 50%; background: currentColor; }
        .status.working .status-dot { animation: pulse 1s infinite; }
        @keyframes pulse { 0%, 100% { opacity: 1; } 50% { opacity: 0.3; } }
        .messages { flex: 1; overflow-y: auto; padding: 16px; display: flex; flex-direction: column; gap: 12px; -webkit-overflow-scrolling: touch; }
        .message { max-width: 88%; animation: fadeIn 0.2s ease; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(8px); } to { opacity: 1; transform: translateY(0); } }
        .message.user { align-self: flex-end; }
        .message.assistant { align-self: flex-start; }
        .bubble { padding: 12px 16px; border-radius: 18px; line-height: 1.5; font-size: 0.9375rem; word-wrap: break-word; }
        .message.user .bubble { background: var(--user-bubble); color: white; border-bottom-right-radius: 4px; }
        .message.assistant .bubble { background: var(--claude-bubble); border-bottom-left-radius: 4px; }
        .bubble pre { background: var(--bg-primary); padding: 10px; border-radius: 8px; overflow-x: auto; margin: 8px 0; font-size: 0.8rem; }
        .bubble code { font-family: 'SF Mono', Monaco, monospace; background: rgba(0,0,0,0.2); padding: 2px 6px; border-radius: 4px; font-size: 0.85em; }
        .bubble pre code { background: none; padding: 0; }
        .bubble strong { color: #60a5fa; }
        .meta { font-size: 0.7rem; color: var(--text-secondary); margin-top: 4px; padding: 0 4px; display: flex; gap: 8px; align-items: center; }
        .meta .model-tag { padding: 2px 6px; border-radius: 4px; font-weight: 500; }
        .meta .model-tag.local { background: rgba(34,197,94,0.2); color: var(--success); }
        .typing { display: none; align-self: flex-start; padding: 12px 16px; background: var(--claude-bubble); border-radius: 18px; border-bottom-left-radius: 4px; }
        .typing.visible { display: flex; gap: 4px; }
        .typing span { width: 8px; height: 8px; background: var(--text-secondary); border-radius: 50%; animation: bounce 1.4s ease-in-out infinite; }
        .typing span:nth-child(2) { animation-delay: 0.16s; }
        .typing span:nth-child(3) { animation-delay: 0.32s; }
        @keyframes bounce { 0%, 80%, 100% { transform: translateY(0); } 40% { transform: translateY(-6px); } }
        .input-area { padding: 12px 16px; padding-bottom: max(12px, env(safe-area-inset-bottom)); background: var(--bg-secondary); border-top: 1px solid rgba(59,130,246,0.2); }
        .quick-actions { display: flex; gap: 8px; overflow-x: auto; padding-bottom: 10px; -webkit-overflow-scrolling: touch; }
        .quick-btn { flex-shrink: 0; padding: 6px 12px; background: var(--bg-primary); border: 1px solid rgba(59,130,246,0.3); border-radius: 16px; color: var(--text-secondary); font-size: 0.75rem; cursor: pointer; transition: all 0.2s; }
        .quick-btn:hover { background: var(--accent); color: white; border-color: var(--accent); }
        .input-row { display: flex; gap: 10px; align-items: flex-end; }
        .input-wrapper { flex: 1; background: var(--bg-primary); border: 1px solid rgba(59,130,246,0.3); border-radius: 24px; padding: 8px 16px; }
        .input-wrapper:focus-within { border-color: var(--accent); }
        #message-input { width: 100%; background: transparent; border: none; color: var(--text-primary); font-size: 16px; line-height: 1.4; resize: none; max-height: 120px; min-height: 24px; outline: none; }
        .send-btn { width: 44px; height: 44px; border-radius: 50%; background: var(--accent); border: none; color: white; font-size: 18px; cursor: pointer; }
        .send-btn:disabled { opacity: 0.5; }
        .router-info { text-align: center; font-size: 0.7rem; color: var(--text-secondary); padding: 4px 0; }
    </style>
</head>
<body>
    <div id="app" class="app">
        <header>
            <div class="logo"><span>üè†</span><h1>BidDeed.AI V18</h1></div>
            <div id="status" class="status ready"><span class="status-dot"></span><span id="status-text">Ready</span></div>
        </header>
        <div class="router-info">üöÄ Everest Summit Edition ‚Äî Intelligent NLP Engine</div>
        <div id="messages" class="messages">
            <div class="message assistant">
                <div class="bubble">üëã <strong>BidDeed.AI V18</strong> ‚Äî Everest Summit Edition<br><br>üìÖ <strong>Upcoming Auctions:</strong><br>‚Ä¢ <strong>Dec 18, 2025</strong> - Tax Deed @ 9AM ONLINE (brevard.realforeclose.com)<br>‚Ä¢ <strong>Jan 7, 2026</strong> - Foreclosure @ 11AM Titusville Courthouse<br><br>üí¨ Try the quick actions below or ask me anything about Brevard County foreclosures!</div>
            </div>
        </div>
        <div id="typing" class="typing"><span></span><span></span><span></span></div>
        <div class="input-area">
            <div class="quick-actions">
                <button class="quick-btn" onclick="sendQuick('What auctions are on Dec 18?')">üìÖ Dec 18 Auction</button>
                <button class="quick-btn" onclick="sendQuick('Explain max bid formula')">üí∞ Max Bid Formula</button>
                <button class="quick-btn" onclick="sendQuick('Show auction calendar')">üìÜ Calendar</button>
                <button class="quick-btn" onclick="sendQuick('How do liens work?')">‚öñÔ∏è Lien Priority</button>
            </div>
            <div class="input-row">
                <div class="input-wrapper"><textarea id="message-input" placeholder="Ask about auctions..." rows="1" onkeydown="handleKeydown(event)" oninput="autoResize(this)"></textarea></div>
                <button id="send-btn" class="send-btn" onclick="sendMessage()">‚û§</button>
            </div>
        </div>
    </div>

    <script>
        // BidDeed.AI V18 - Intelligent NLP Response Engine
        // Works offline with smart pattern matching
        
        function setStatus(status, text) {
            const el = document.getElementById('status');
            el.className = 'status ' + status;
            document.getElementById('status-text').textContent = text;
        }

        function renderMessage(role, content, meta = null) {
            const container = document.getElementById('messages');
            const div = document.createElement('div');
            div.className = 'message ' + (role === 'user' ? 'user' : 'assistant');
            
            const time = new Date().toLocaleTimeString('en-US', { hour: 'numeric', minute: '2-digit' });
            let html = content
                .replace(/```(\w*)\n([\s\S]*?)```/g, '<pre><code>$2</code></pre>')
                .replace(/`([^`]+)`/g, '<code>$1</code>')
                .replace(/\*\*([^*]+)\*\*/g, '<strong>$1</strong>')
                .replace(/##\s+(.+)/g, '<strong style="display:block;margin:12px 0 8px;font-size:1.05em">$1</strong>')
                .replace(/- \*\*([^*]+)\*\*/g, '‚Ä¢ <strong>$1</strong>')
                .replace(/^- (.+)$/gm, '‚Ä¢ $1')
                .replace(/\n/g, '<br>');
            
            let metaHtml = `<span>${time}</span>`;
            if (meta) {
                metaHtml += `<span class="model-tag local">‚ö° BidDeed AI</span>`;
            }
            
            div.innerHTML = `<div class="bubble">${html}</div><div class="meta">${metaHtml}</div>`;
            container.appendChild(div);
            container.scrollTop = container.scrollHeight;
        }

        // Intelligent Response Generator
        function generateResponse(message) {
            const lower = message.toLowerCase();
            
            // December 18 / Tax Deed queries
            if (/dec\s*18|december\s*18|tax\s*deed|tomorrow/.test(lower)) {
                return `üìÖ **December 18, 2025 ‚Äî Tax Deed Auction**

**Details:**
‚Ä¢ **Time:** 9:00 AM EST
‚Ä¢ **Location:** ONLINE at brevard.realforeclose.com
‚Ä¢ **Type:** Tax Deed Sale

**How to Participate:**
1. Go to brevard.realforeclose.com
2. Create an account (if you haven't already)
3. Deposit required funds
4. Look for "BID NOW" links starting at 9:00 AM

**Key Differences from Foreclosure:**
‚Ä¢ Tax deeds wipe out ALL liens (except government)
‚Ä¢ You get the property, not just the lien
‚Ä¢ Due diligence period is shorter

‚ö†Ô∏è **Tip:** Properties with "BID NOW" buttons are active. Research parcels beforehand using BCPAO.us!`;
            }
            
            // Calendar / Schedule queries
            if (/calendar|schedule|when|next|upcoming|auction/.test(lower) && !/dec\s*18/.test(lower)) {
                return `üìÜ **Brevard County Auction Calendar**

**Upcoming Auctions:**

üìç **December 18, 2025** (Thursday)
‚Ä¢ Type: Tax Deed Auction
‚Ä¢ Time: 9:00 AM
‚Ä¢ Location: ONLINE ‚Äî brevard.realforeclose.com

üìç **January 7, 2026** (Tuesday)
‚Ä¢ Type: Foreclosure Auction
‚Ä¢ Time: 11:00 AM
‚Ä¢ Location: IN-PERSON ‚Äî Titusville Courthouse

**Auction Types:**
‚Ä¢ **Foreclosure:** In-person at courthouse, highest bidder wins property
‚Ä¢ **Tax Deed:** Online bidding, wipes most liens

üí° Foreclosure auctions happen 1st & 3rd Tuesdays (typically). Tax deed auctions are scheduled monthly.`;
            }
            
            // Max bid formula
            if (/max\s*bid|formula|calculate|how\s*much/.test(lower)) {
                return `üí∞ **BidDeed.AI Max Bid Formula**

\`\`\`
Max Bid = (ARV √ó 70%) - Repairs - $10K - MIN($25K, 15% √ó ARV)
\`\`\`

**Components Explained:**

‚Ä¢ **ARV** = After Repair Value (comparable sales from BCPAO)
‚Ä¢ **70%** = Safety margin for profit & unexpected costs
‚Ä¢ **Repairs** = Estimated rehab costs
‚Ä¢ **$10K** = Fixed costs (closing, holding, utilities)
‚Ä¢ **MIN($25K, 15% ARV)** = Wholesale profit cap

**Example:**
- ARV: $300,000
- Repairs: $40,000
- Max Bid = ($300K √ó 70%) - $40K - $10K - $25K
- Max Bid = $210K - $40K - $10K - $25K = **$135,000**

**Bid/Judgment Ratio Guide:**
‚Ä¢ üü¢ ‚â•75% ‚Üí **BID** (strong opportunity)
‚Ä¢ üü° 60-74% ‚Üí **REVIEW** (proceed with caution)
‚Ä¢ üî¥ <60% ‚Üí **SKIP** (too risky)`;
            }
            
            // Lien priority
            if (/lien|survive|priority|hoa|mortgage|title/.test(lower)) {
                return `‚öñÔ∏è **Lien Priority in Florida Foreclosures**

**The Golden Rule:** Senior liens SURVIVE junior foreclosures.

**Lien Priority (Typical Order):**
1. Property Taxes (always first)
2. First Mortgage (original purchase loan)
3. Second Mortgage / HELOC
4. HOA/Condo Liens
5. Judgment Liens
6. Mechanics Liens

**Critical Scenarios:**

üè¶ **Bank Foreclosure (Mortgage):**
‚Ä¢ Wipes: HOA liens, junior mortgages, judgments
‚Ä¢ You get: Clean title (usually)

üèòÔ∏è **HOA Foreclosure:**
‚Ä¢ ‚ö†Ô∏è **DANGER:** Senior mortgage SURVIVES
‚Ä¢ You inherit: The entire first mortgage!
‚Ä¢ Always check: Who is the plaintiff?

üèõÔ∏è **Tax Deed Sale:**
‚Ä¢ Wipes: Almost everything
‚Ä¢ Survives: Some government liens, EPA liens

**BidDeed.AI Protection:**
Our Lien Discovery Agent searches AcclaimWeb to find ALL recorded liens before you bid. Never guess ‚Äî we check actual records.`;
            }
            
            // Properties / recommendations
            if (/properties|recommend|best|bid|invest|opportunities/.test(lower)) {
                return `‚≠ê **Investment Opportunities**

BidDeed.AI uses the **Everest Ascent‚Ñ¢** 12-stage pipeline to analyze properties:

**Our Process:**
1. Discovery ‚Äî Find auction listings
2. Scraping ‚Äî Pull property data from BCPAO
3. Title Search ‚Äî Check ownership history
4. Lien Priority ‚Äî Identify surviving liens
5. Tax Certs ‚Äî Check for outstanding taxes
6. Demographics ‚Äî Analyze neighborhood
7. CMA ‚Äî Run comparable market analysis
8. ML Score ‚Äî Apply 64.4% accuracy model
9. Max Bid ‚Äî Calculate optimal bid price
10. Decision ‚Äî Generate BID/REVIEW/SKIP
11. Report ‚Äî Create investment summary
12. Archive ‚Äî Store for future reference

**Current Recommendations:**
To see live BID recommendations for upcoming auctions, check our full analysis reports or ask about a specific property address.

üìä **ML Model Stats:**
‚Ä¢ 64.4% accuracy on third-party predictions
‚Ä¢ 28 plaintiff patterns tracked
‚Ä¢ Historical data from 1,393+ auctions`;
            }
            
            // Help / general
            if (/help|what\s*can|how\s*to|commands/.test(lower)) {
                return `ü§ñ **BidDeed.AI V18 ‚Äî Help**

**I can help you with:**

üìÖ **Auction Info**
‚Ä¢ "What auctions are on Dec 18?"
‚Ä¢ "Show the auction calendar"
‚Ä¢ "When is the next foreclosure?"

üí∞ **Investment Analysis**
‚Ä¢ "Explain the max bid formula"
‚Ä¢ "What's a good bid/judgment ratio?"
‚Ä¢ "How do I calculate repairs?"

‚öñÔ∏è **Title & Liens**
‚Ä¢ "How do liens work?"
‚Ä¢ "What survives an HOA foreclosure?"
‚Ä¢ "Explain lien priority"

üè† **Properties**
‚Ä¢ "Show best opportunities"
‚Ä¢ "Analyze [property address]"

üìä **Market Data**
‚Ä¢ "Demographics for Melbourne"
‚Ä¢ "Market trends in Brevard"

Just type your question naturally ‚Äî I understand context!`;
            }
            
            // Hello / greeting
            if (/^(hi|hello|hey|good\s*(morning|afternoon|evening)|greetings)/i.test(lower)) {
                return `üëã Hello! I'm **BidDeed.AI V18**, your foreclosure auction assistant.

**Quick Info:**
üìÖ Next auction: **Dec 18** (Tax Deed) @ 9AM ONLINE
üèõÔ∏è After that: **Jan 7** (Foreclosure) @ 11AM Titusville

What would you like to know about Brevard County auctions?`;
            }
            
            // Default response
            return `ü§î I understand you're asking about: "${message.substring(0, 50)}${message.length > 50 ? '...' : ''}"

Here's what I can help with:

üìÖ **Auctions:** "What's on Dec 18?" or "Show calendar"
üí∞ **Formulas:** "Explain max bid formula"
‚öñÔ∏è **Liens:** "How does lien priority work?"
üè† **Analysis:** "Show best opportunities"

Try one of the quick action buttons below, or rephrase your question!`;
        }

        function sendMessage() {
            const input = document.getElementById('message-input');
            const content = input.value.trim();
            if (!content) return;

            renderMessage('user', content);
            input.value = '';
            autoResize(input);
            
            setStatus('working', 'Thinking...');
            document.getElementById('typing').classList.add('visible');
            document.getElementById('send-btn').disabled = true;
            
            // Simulate brief processing time
            setTimeout(() => {
                const response = generateResponse(content);
                renderMessage('assistant', response, { local: true });
                setStatus('ready', 'Ready');
                document.getElementById('typing').classList.remove('visible');
                document.getElementById('send-btn').disabled = false;
            }, 400 + Math.random() * 400);
        }

        function sendQuick(text) { 
            document.getElementById('message-input').value = text; 
            sendMessage(); 
        }
        
        function handleKeydown(e) { 
            if (e.key === 'Enter' && !e.shiftKey) { 
                e.preventDefault(); 
                sendMessage(); 
            } 
        }
        
        function autoResize(el) { 
            el.style.height = 'auto'; 
            el.style.height = Math.min(el.scrollHeight, 120) + 'px'; 
        }
    </script>
</body>
</html>
