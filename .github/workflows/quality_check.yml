# .github/workflows/quality_check.yml
# BidDeed.AI Quality Gates
# Deployed: January 3, 2026
# Purpose: Run linting and type checks on PRs

name: âœ… Quality Check

on:
  pull_request:
    branches: [main, develop]
  push:
    branches: [main]

jobs:
  lint-and-type:
    runs-on: ubuntu-latest
    timeout-minutes: 10

    steps:
      - name: ðŸ“¥ Checkout code
        uses: actions/checkout@v4

      - name: ðŸ Set up Python
        uses: actions/setup-python@v5
        with:
          python-version: '3.11'
          cache: 'pip'

      - name: ðŸ“¦ Install quality tools
        run: |
          pip install ruff mypy
          pip install -r requirements.txt

      - name: ðŸ” Ruff check
        run: |
          echo "Running ruff linter..."
          ruff check . --output-format=github
        continue-on-error: false

      - name: ðŸŽ¨ Ruff format check
        run: |
          echo "Checking code formatting..."
          ruff format --check .
        continue-on-error: false

      - name: ðŸ”¬ MyPy type check
        run: |
          echo "Running static type analysis..."
          mypy src/ --show-error-codes --pretty
        continue-on-error: true  # Don't block on type errors initially

      - name: ðŸ“Š Summary
        if: always()
        run: |
          echo "## Quality Check Results" >> $GITHUB_STEP_SUMMARY
          echo "" >> $GITHUB_STEP_SUMMARY
          echo "âœ… Ruff linting passed" >> $GITHUB_STEP_SUMMARY
          echo "âœ… Code formatting verified" >> $GITHUB_STEP_SUMMARY
          echo "â„¹ï¸ Type checking completed (warnings allowed)" >> $GITHUB_STEP_SUMMARY
